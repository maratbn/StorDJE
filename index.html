<!DOCTYPE html>

<html>
  <head>
    <title>
      StorDJE - Storage layer add-on module for the Dojo Toolkit event system
    </title>
    <link
        rel='stylesheet'
        href='/jquery/jquery-ui-1.8.7.custom/development-bundle/themes/ui-lightness/jquery.ui.core.css'>
    <link
        rel='stylesheet'
        href='/jquery/jquery-ui-1.8.7.custom/development-bundle/themes/ui-lightness/jquery.ui.button.css'>
    <link
        rel='stylesheet'
        href='/jquery/jquery-ui-1.8.7.custom/development-bundle/themes/ui-lightness/jquery.ui.theme.css'>
    <style type='text/css'>
        .stordje_support {
            font-family:                    sans-serif;
            font-size:                      10pt;
            width:                          90%;
            margin:                         auto;
        }

        .stordje_support .quick_links {
            float:                          right;
            margin-left:                    15px;
        }

        .stordje_support .input--width {
            width:                          200px;
        }
        .stordje_support .dcodeview {
            width:                          55em;
        }
    </style>
  </head>
  <body class='stordje_support'>
    <h1>
      StorDJE - Storage layer add-on module for the Dojo Toolkit event system
    </h1>
    <div class='quick_links'>
      <p>
        <h3>
          <a href='https://github.com/maratbn/stordje/'>
            Browse source
          </a>
        </h3>
        <h3>
          <a href='https://github.com/maratbn/StorDJE/raw/master/stordje.js'>
            Download source
          </a>
        </h3>
      </p>
    </div>
    <ul>
      <li>
        <h3>Description</h3>
        <ul>
          <li>
            <h4>Background:</h4>
            <p>
    The Dojo Toolkit, for which this module is intended, features a versatile
    topic-based event publishing and subscription framework, that allows
    widgets throughout the application to receive notifications of various
    events and associated data.
            </p>
            <p>
    However, as of version 1.5.0, the Dojo Toolkit lacks a utility to also
    allow retrieval of previously published event data, preventing the event
    system from being used to store data for the application model.
            </p>
            <p>
    Such a capability is useful for UI components that are created by their
    parent components upon notification of (and obviously after) a particular
    event, but that still periodically require the latest data on that or
    other event topic(s) throughout their lifecycle.
            </p>
          </li>
          <li>
            <h4>Overview and purpose:</h4>
            <p>
    This is a storage layer add-on module for the Dojo Toolkit event system.
    It can be 'require'd via the Dojo module loading system, and be used for
    the retrieval of previously-published topic-based event data, making it
    possible for application components to access event data that either could
    not be received, or was not needed, at the time it was originally
    published.
            </p>
          </li>
        </ul>
      </li>
      <li>
        <h3>Test StorDJE in your browser:</h3>
        <ol>
          <li>
            Enter an arbitrary event name and some text data below, and click
            the 'Store' button:
            <div dojoType='StoreEventDataWidget'></div>
          </li>
          <li>
            Enter the same event name below as entered above, and click the
            'Recall' button to load and display the text data just entered:
            <div dojoType='RecallEventDataWidget'></div>
          </li>
        </ol>
      </li>
      <li>
        <h3>To Use the StorDJE module in your project:</h3>
        <ol>
          <li>
            Include the path to the 'stordje' module in the 'djConfig'
            'modulePaths' parameter by specifying the HTTP/S path to the
            StorDJE JavaScript file without the '.js'  extension:
            <pre dojoType='dcodeview.DCodeView' class='dcodeview'>
&lt;script
  type='text/javascript'
  src='/dojo-release-1.5.0/dojo/dojo.js'
  djConfig="parseOnLoad: true, modulePaths:{'stordje':'/stordje/stordje'}"&gt;
&lt;/script&gt;
            </pre>
          </li>
          <li>
            Instead of calling the 'publish(...)' method of the 'dojo' module
            like this:
            <pre dojoType='dcodeview.DCodeView' class='dcodeview'>
dojo.publish('my-event', ["my event data"]);
            </pre>
            Change the module from 'dojo' to 'stordje' like this:
            <pre dojoType='dcodeview.DCodeView' class='dcodeview'>
dojo.require('stordje');
stordje.publish('my-event', ["my event data"]);
            </pre>
            The method arguments remain exactly the same.  The method
            'stordje.publish(...)' still calls 'dojo.publish(...)' internally
            after saving the event data to a hash map.
          </li>
          <li>
            To recall the event data, call either the 'recall(...)' or
            'recallFirst(...)' method of the stordje module:
            <pre dojoType='dcodeview.DCodeView' class='dcodeview'>
dojo.require('stordje');
var arrData = stordje.recall('my-event');       // Returns the stored string
                                                // wrapped inside an array.

var strData = stordje.recallFirst('my-event');  // Returns just the stored
                                                // string.
            </pre>
            These methods simply retrieve the event data from the same hash
            map to which it was previously saved by 'stordje.publish(...)'.
            The 'recallFirst(...)' method was added for convenience to unwrap
            the data from the array in which it was originally published.
          </li>
        </ol>
      </li>
    </ul>
    <div>
      Copyright (c) 2010 Marat Nepomnyashy
      <br>
      The StorDJE utility source code is
      <a href='http://github.com/maratbn/stordje/raw/master/LICENSE'>
        licensed
      </a>
      under the
      <a href='http://www.opensource.org/licenses/bsd-license.php'>
        BSD license
      </a>.
    </div>
    <script
        type='text/javascript'
        src='/jquery/jquery-1.4.4.min.js'>
    </script>
    <script
        type='text/javascript'
        src='/jquery/jquery-ui-1.8.7.custom/development-bundle/ui/jquery.ui.core.js'>
    </script>
    <script
        type='text/javascript'
        src='/jquery/jquery-ui-1.8.7.custom/development-bundle/ui/jquery.ui.widget.js'>
    </script>
    <script
        type='text/javascript'
        src='/jquery/jquery-ui-1.8.7.custom/development-bundle/ui/jquery.ui.button.js'>
    </script>

    <script
        type='text/javascript'
        src='/dojo-release-1.5.0/dojo/dojo.js'
        djConfig="parseOnLoad: true, modulePaths:{'stordje':'/stordje/stordje', 'dcodeview':'/dcodeview/dojo_dcodeview/'}">
    </script>
    <script type='text/javascript'>
        //<!--
        dojo.require('dcodeview.DCodeView');    // This is for displaying the
                                                // example code in a pretty
                                                // way.

        dojo.require('dijit._Templated');
        dojo.require('dijit._Widget');

        dojo.declare('EventDataWidget', [dijit._Widget, dijit._Templated], {
                button_caption: "",
                button_icon: "",

                templateString: [
                        "<table>",
                          "<tr>",
                            "<td valign='top'>",
                              "Event name:",
                            "</td>",
                            "<td valign='top'>",
                              "<input type='text' value='my-event'",
                                  " class='input--width'",
                                  " dojoAttachPoint='_elEventName'",
                                "></input>",
                            "</td>",
                            "<td rowspan='2' valign='top'>",
                              "<button dojoAttachPoint='_elButton'",
                                  " dojoAttachEvent='onclick:_onButtonClicked'>",
                                "${button_caption}",
                              "</button>",
                            "</td>",
                          "</tr>",
                          "<tr>",
                            "<td valign='top'>",
                              "Event data:",
                            "</td>",
                            "<td valign='top'>",
                              "<textarea class='input--width'",
                                  " dojoAttachPoint='_elEventData'>",
                              "</textarea>",
                            "</td>",
                          "</tr>",
                        "</table>"].join(""),

                postCreate: function() {
                    this.inherited(arguments);

                    $(this._elButton).button({
                            icons: {
                                primary: this.button_icon
                            }
                        });
                },

                destroy: function() {
                    $(this._elButton).button('destroy');

                    this.inherited(arguments);
                },

                _onButtonClicked: function() {
                }
            });

        dojo.declare('StoreEventDataWidget', EventDataWidget, {
                button_caption: "Store",
                button_icon: 'ui-icon-arrowthick-1-se',

                postCreate: function() {
                    this.inherited(arguments);

                    dojo.attr(
                        this._elEventData,
                        'value',
                        "some text data to store for this event...");
                },

                _onButtonClicked: function() {
                    this.inherited(arguments);

                    var strEventName = dojo.attr(this._elEventName, 'value');
                    var strEventData = dojo.attr(this._elEventData, 'value');

                    dojo.require('stordje');
                    stordje.publish(strEventName, [strEventData]);
                }
            });

        dojo.declare('RecallEventDataWidget', EventDataWidget, {
                button_caption: "Recall",
                button_icon: 'ui-icon-arrowthick-1-ne',

                _onButtonClicked: function() {
                    this.inherited(arguments);

                    var strEventName = dojo.attr(this._elEventName, 'value');

                    dojo.require('stordje');
                    var strEventData = stordje.recallFirst(strEventName);

                    dojo.attr(this._elEventData, 'value', strEventData
                                                                    || "");
                }
            });
        //-->
    </script>
  </body>
</html>
